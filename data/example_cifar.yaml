experiment: Cifar100
task: test_pretrained

sampled_features:
  - lib.data.features.RGBImage
  - lib.data.features.IntLabel

# Model ===============================================================================
model:
  _target_: timm.models.create_model
  model_name: resnet50
  pretrained: True
  num_classes: 100

model_input_feature: rgb_image

checkpoints: /home/vladislav/PycharmProjects/imagenet_pipeline/data/checkpoints
# ======================================================================================

# Train ================================================================================
train_data:
  cifar-100:
    path: /home/vladislav/Data/CIFAR100
    info_path: /home/vladislav/Data/CIFAR100/info.csv
    filter_by:
      part: train
    weight: 1.0

n_epochs: ???
batch_size: 16
num_workers: 0

epoch_length: 100

transforms: lib.data.transforms.channel_last
post_processing: lib.post_processing.logit_processing

augmentations:
  - albumentations.Flip:
      p: 0.5
  - albumentations.ShiftScaleRotate:
      shift_limit: 0.0625
      scale_limit: 0.05
      rotate_limit: 15.0
      p: 0.2
  - albumentations.Normalize:
      mean: [ 0.485, 0.456, 0.406 ]
      std: [ 0.229, 0.224, 0.225 ]
      always_apply: True

optimizer:
  _target_: torch.optim.Adam
  lr: 0.0001
  amsgrad: False

scheduler:
  _target_: torch.optim.lr_scheduler.CosineAnnealingLR
  T_max: 50
  eta_min: 0.00001

losses:
  cross-entropy:
    callable:
      _target_: torch.nn.CrossEntropyLoss
    args:
      input: model_output.logits
      target: batch.int_label
    weight: 1.0
# ======================================================================================

# Develop ==============================================================================
dev_data:
  cifar-100:
    path: /home/vladislav/Data/CIFAR100
    info_path: /home/vladislav/Data/CIFAR100/info.csv
    filter_by:
      part: test
    weight: 1.0

dev_transforms: lib.data.transforms.channel_last

dev_augmentations:
  - albumentations.Normalize:
      mean: [ 0.485, 0.456, 0.406 ]
      std: [ 0.229, 0.224, 0.225 ]
      always_apply: True

metrics:
  ACC: sklearn.metrics.accuracy_score
# ======================================================================================